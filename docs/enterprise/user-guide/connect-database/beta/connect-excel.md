# 连接 Excel

Excel 是使用广泛的数据统计和数据分析软件，Tapdata 支持读取本地、FTP、SFTP、SMB、S3FS 或 OSS 上的 Excel 文件，满足多样化的数据流转需求。本文介绍如何在 Tapdata 上连接 Excel 数据源。

## 支持的文件格式

支持 XLS/XLSX 格式，可支持包含合并单元格的表单、包含公式输入的表单。

## 注意事项

- 一个连接配置仅对应一个模型（表），如有多个模型您需要分别为其创建链接。

- Excel 数据源仅适用于数据转换任务，暂不支持在数据复制任务中引用。
- 为避免超大 Excel 文件占满机器内存，推荐 Excel 文件不超过 512 MB。
- Tapdata 默认每隔 1 分钟检测 Excel 文件是否发生变更（如新增/修改文件），如发生变更则将涉及的文件全量新增后更新条件字段以完成修改，暂不支持同步删除文件或数据。
- Excel 文件中可用的数据类型为 BOOLEAN、DATE、DOUBLE、STRING、TEXT。

## 操作步骤

1. 登录 Tapdata 平台。

2. 在左侧导航栏，单击**连接管理**。

3. 在页面右侧，单击**创建**。

4. 在弹出的对话框中，搜索并选择 **Excel**。

5. 在跳转到的页面，根据下述说明填写 Excel 的连接信息。

   ![连接 Excel](../../../images/connect_excel.png)

   * **连接名称**：填写具有业务意义的独有名称。
   * **连接类型**：目前仅支持**源头**。
   * **文件协议**：根据 Excel 文件存放的位置选择下述协议，本文以 **FTP** 为例演示操作流程。     
     :::tip     
     关于如何获取各协议所需填写的信息，见 [CSV/EXCEL 数据源准备工作](../../../prerequisites/beta/csv-and-excel.md)。     
     :::     
     * **Local**：文件存放在本地（引擎）所在的设备上，选择此项后，您还需要填写文件路径。
     * **FTP**（文件传输协议）：文件存放在 FTP 服务器上，选择此项后，您还需要填写 FTP 服务器的地址、端口、用户名、口令、文件路径等信息，如上图所示。
     * **SFTP**（安全加密文件传输协议）：文件存放在 SFTP 服务器上，选择此项后，您还需要填写 SFTP 服务器的地址、端口、用户名、口令、文件路径等信息。
     * **SMB**（文件共享协议）：文件存放在 SMB 服务器上，兼容 1.x、2.x、3.x，选择此项后，您还需要填写 SMB 服务器的地址、用户名、口令、文件路径等信息。
     * **S3FS**（遵循S3协议文件系统）：文件存放在 Amazon S3 存储桶上，选择此项后，您还需要填写 Accesskey、Secretkey、终端（固定为 **s3.amazonaws.com**）、桶和文件路径等信息。
     * **OSS**（对象存储服务）：文件存放在阿里云对象存储 OSS 上，选择此项后，您还需要填写云账户的 Accesskey、Secretkey、终端、桶和文件路径等信息。     
   * **共享挖掘**：打开该开关后，Tapdata 会挖掘增量日志并存储起来，无需重复采集源库的变更信息，可极大地缓解对源库资源的占用。更多介绍，见[共享挖掘](../../advanced-settings/share-mining.md)。     
   * **Agent 设置**：默认为**平台自动分配**，您也可以手动指定。
   * **模型加载时间**：当数据源中模型数量小于 10,000 时，每小时刷新一次模型信息；如果模型数据超过 10,000，则每天按照您指定的时间刷新模型信息。
   * **开启心跳表**：当连接类型选择为**源头和目标**、**源头**时，支持打开该开关，由 Tapdata 在源库中创建一个名为 **_tapdata_heartbeat_table** 的心跳表并每隔 10 秒更新一次其中的数据（数据库账号需具备相关权限），用于数据源连接与任务的健康度监测，更多介绍，见[通过心跳表监测数据同步链路](../../../best-practice/heart-beat-task.md)。
     
     :::tip
     
     数据源需在数据复制/开发任务引用并启动后，心跳任务任务才会启动，此时您可以再次进入该数据源的编辑页面，即可单击**查看心跳任务**。
     
     :::

6. 单击**连接测试**，测试通过后单击**保存**。

   :::tip

   如提示连接测试失败，请根据页面提示进行修复。

   :::



## 相关文档

[采集 Excel 数据至 MySQL](../../../best-practice/excel-to-mysql.md)
